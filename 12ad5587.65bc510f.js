(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{159:function(n,e,t){"use strict";t.d(e,"a",(function(){return u})),t.d(e,"b",(function(){return j}));var o=t(0),a=t.n(o);function c(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function r(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?s(Object(t),!0).forEach((function(e){c(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function l(n,e){if(null==n)return{};var t,o,a=function(n,e){if(null==n)return{};var t,o,a={},c=Object.keys(n);for(o=0;o<c.length;o++)t=c[o],e.indexOf(t)>=0||(a[t]=n[t]);return a}(n,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(o=0;o<c.length;o++)t=c[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}var i=a.a.createContext({}),p=function(n){var e=a.a.useContext(i),t=e;return n&&(t="function"==typeof n?n(e):r({},e,{},n)),t},u=function(n){var e=p(n.components);return a.a.createElement(i.Provider,{value:e},n.children)},m={inlineCode:"code",wrapper:function(n){var e=n.children;return a.a.createElement(a.a.Fragment,{},e)}},b=Object(o.forwardRef)((function(n,e){var t=n.components,o=n.mdxType,c=n.originalType,s=n.parentName,i=l(n,["components","mdxType","originalType","parentName"]),u=p(t),b=o,j=u["".concat(s,".").concat(b)]||u[b]||m[b]||c;return t?a.a.createElement(j,r({ref:e},i,{components:t})):a.a.createElement(j,r({ref:e},i))}));function j(n,e){var t=arguments,o=e&&e.mdxType;if("string"==typeof n||o){var c=t.length,s=new Array(c);s[0]=b;var r={};for(var l in e)hasOwnProperty.call(e,l)&&(r[l]=e[l]);r.originalType=n,r.mdxType="string"==typeof n?n:o,s[1]=r;for(var i=2;i<c;i++)s[i]=t[i];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"},94:function(n,e,t){"use strict";t.r(e),t.d(e,"frontMatter",(function(){return c})),t.d(e,"metadata",(function(){return s})),t.d(e,"rightToc",(function(){return r})),t.d(e,"default",(function(){return i}));var o=t(1),a=(t(0),t(159));const c={id:"Asyncawait",title:"async / await (\u7a76\u6975\u7570\u6b65\u8655\u7406\u65b9\u6848)",sidebar_label:"async / await (\u7a76\u6975\u7570\u6b65\u8655\u7406\u65b9\u6848)"},s={id:"Asyncawait",title:"async / await (\u7a76\u6975\u7570\u6b65\u8655\u7406\u65b9\u6848)",description:"## \u57fa\u672c\u4ecb\u7d39\r",source:"@site/docs\\Asyncawait.md",permalink:"/ArhuaReactCourse/docs/Asyncawait",sidebar_label:"async / await (\u7a76\u6975\u7570\u6b65\u8655\u7406\u65b9\u6848)",sidebar:"someSidebar",previous:{title:"Fetch \u767c\u9001\u8acb\u6c42(request)",permalink:"/ArhuaReactCourse/docs/Fetch"},next:{title:"React\u5982\u4f55\u69cb\u5efa\u756b\u9762",permalink:"/ArhuaReactCourse/docs/ReactBuildUI"}},r=[{value:"\u57fa\u672c\u4ecb\u7d39",id:"\u57fa\u672c\u4ecb\u7d39",children:[]},{value:"\u6dfa\u51fa async \u51fd\u6578",id:"\u6dfa\u51fa-async-\u51fd\u6578",children:[{value:"async \u51fd\u6578\u56de\u50b3\u503c\u8207\u5176\u5167\u932f\u8aa4",id:"async-\u51fd\u6578\u56de\u50b3\u503c\u8207\u5176\u5167\u932f\u8aa4",children:[]},{value:"async \u51fd\u6578\u4f75\u767c\u8207\u7e7c\u767c",id:"async-\u51fd\u6578\u4f75\u767c\u8207\u7e7c\u767c",children:[]}]},{value:"\u4f7f\u7528\u578b\u5f0f",id:"\u4f7f\u7528\u578b\u5f0f",children:[]},{value:"Async \u51fd\u6578\u7a0b\u5f0f\u78bc\u7247\u6bb5 (Snippets)\u9023\u7d50",id:"async-\u51fd\u6578\u7a0b\u5f0f\u78bc\u7247\u6bb5-snippets\u9023\u7d50",children:[]}],l={rightToc:r};function i({components:n,...e}){return Object(a.b)("wrapper",Object(o.a)({},l,e,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"\u57fa\u672c\u4ecb\u7d39"},"\u57fa\u672c\u4ecb\u7d39"),Object(a.b)("p",null,"ES2017 \u6a19\u6e96\u5f15\u5165\u4e86async \u51fd\u6578\uff0c\u6709\u4e86async \u51fd\u6578\u5f8c\u4f7f\u5f97\u7570\u6b65\u64cd\u4f5c\u8b8a\u5f97\u66f4\u52a0\u65b9\u4fbf\uff0c\u8b93\u6211\u5011\u53ef\u4ee5\u4e0d\u7528\u518d\u906d\u9047\u4ee5\u524d\u7684CallBack hell\uff0c\u6240\u4ee5\u7a31\u4ed6\u70ba\u7a76\u6975\u7570\u6b65\u8655\u7406\u65b9\u6848\u3002 "),Object(a.b)("p",null,"\u9996\u5148\uff0casync \u51fd\u6578\u5167\u901a\u5e38\u642d\u914d await \u547d\u4ee4\u4e00\u8d77\u4f7f\u7528\uff0casync \u51fd\u6578\u5167\u7684\u8a9e\u53e5\uff0c\u82e5\u6c92\u6709\u52a0\u4e0a await \u547d\u4ee4\u5c31\u6703\u4ee5\u7570\u6b65\u7684\u65b9\u5f0f\u57f7\u884c\u6240\u6709\u8a9e\u53e5\uff1b\n\u82e5\u52a0\u4e0a\u4e86await \u547d\u4ee4\u5c31\u6703\u7b49\u5230\u9019\u500bawait \u547d\u4ee4\u5f8c\u9762\u7684\u8a9e\u53e5\u57f7\u884c\u5b8c\u5f8c\uff0c\u518d\u63a5\u8457\u57f7\u884c\u5f8c\u9762\u7684\u8a9e\u53e5\u3002"),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"await\u547d\u4ee4\u5f8c\u9762\uff0c\u53ea\u80fd\u662fPromise\u7269\u4ef6\u548c\u539f\u59cb\u985e\u578b\u7684\u503c\uff08\u6578\u503c\u3001\u5b57\u4e32\u548c\u5e03\u6797\u503c\uff0c\u4f46\u9019\u6642\u6703\u81ea\u52d5\u8f49\u6210\u7acb\u5373resolved\u7684Promise\u7269\u4ef6\uff09\u3002")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"\nconst asyncfunction = async () => {\n    fetch('https://my-json-server.typicode.com/taiwanhua/demo/posts',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n\n    fetch('https://my-json-server.typicode.com/taiwanhua/demo/comments',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (2)\xa0[{\u2026}, {\u2026}]\n\n    fetch('https://my-json-server.typicode.com/taiwanhua/demo/profile', \n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : {name: \"typicode\"}\n}\n\nasyncfunction();\n\n//\u591a\u57f7\u884c\u5e7e\u6b21\u5f8c\uff0c\u6703\u767c\u73fe\u56e0\u70baasync \u51fd\u6578\u5167\u4ee5\u7570\u6b65\u7684\u65b9\u5f0f\u57f7\u884c\u6240\u6709\u8a9e\u53e5\uff0c\u6240\u4ee5\u6bcf\u6b21\u4e0d\u4e00\u5b9a\u6703\u6309\u7167\u7531\u4e0a\u5230\u4e0b\u7684\u65b9\u5f0f\u4f9d\u5e8f\u8f38\u51fa\u5982\u4e0b\n// (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n// (2)\xa0[{\u2026}, {\u2026}]\n// {name: \"typicode\"}\n\n")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"\nconst asyncfunction = async () => {\n    await fetch('https://my-json-server.typicode.com/taiwanhua/demo/posts',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n\n    await fetch('https://my-json-server.typicode.com/taiwanhua/demo/comments',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (2)\xa0[{\u2026}, {\u2026}]\n\n    await fetch('https://my-json-server.typicode.com/taiwanhua/demo/profile', \n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : {name: \"typicode\"}\n}\n\nasyncfunction();\n\n//\u52a0\u4e0a await\u5f8c\u5c31\u6703\u7b49\u5230\u9019\u500bawait \u547d\u4ee4\u5f8c\u9762\u7684\u8a9e\u53e5\u57f7\u884c\u5b8c\u5f8c\uff0c\u518d\u63a5\u8457\u57f7\u884c\u5f8c\u9762\u7684\u8a9e\u53e5\uff0c\u6240\u4ee5\u5c31\u80fd\u4f9d\u5e8f\u8f38\u51fa\u5982\u4e0b\n// (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n// (2)\xa0[{\u2026}, {\u2026}]\n// {name: \"typicode\"}\n\n")),Object(a.b)("p",null,"\u518d\u7d66\u4e00\u500b\u4f8b\u5b50\uff0c\u5be6\u73fe\u4f11\u7720\u6548\u679c\u3002JavaScript\u4e00\u76f4\u6c92\u6709\u4f11\u7720\u7684\u8a9e\u6cd5\uff0c\u4f46\u662f\u85c9\u52a9await\u547d\u4ee4\u5c31\u53ef\u4ee5\u8f03\u7c21\u55ae\u7684\u65b9\u6cd5\u8b93\u7a0b\u5e8f\u505c\u9813\u6307\u5b9a\u7684\u6642\u9593\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"function sleep(interval) {\n  return new Promise(resolve => {\n    setTimeout(resolve, interval);\n  })\n}\n\n// \u7528\u6cd5\nasync function one2FiveInAsync() {\n  for(let i = 1; i <= 5; i++) {\n    console.log(i);\n    await sleep(1000);\n  }\n}\n\none2FiveInAsync();\n")),Object(a.b)("h2",{id:"\u6dfa\u51fa-async-\u51fd\u6578"},"\u6dfa\u51fa async \u51fd\u6578"),Object(a.b)("p",null,"\u4ee5\u4e0b\u5c07\u91dd\u5c0dasync \u51fd\u6578\u5e7e\u500b\u7279\u6027\u4f5c\u5206\u6790\u3002"),Object(a.b)("h3",{id:"async-\u51fd\u6578\u56de\u50b3\u503c\u8207\u5176\u5167\u932f\u8aa4"},"async \u51fd\u6578\u56de\u50b3\u503c\u8207\u5176\u5167\u932f\u8aa4"),Object(a.b)("p",null,"(1) async\u51fd\u6578\u8fd4\u56de\u4e00\u500bPromise \u7269\u4ef6\u3002"),Object(a.b)("p",null,"(2) async\u51fd\u6578\u5167\u90e8return\u8a9e\u53e5\u8fd4\u56de\u7684\u503c\uff0c\u6703\u6210\u70bathen\u65b9\u6cd5\u56de\u8abf\u51fd\u6578\u7684\u53c3\u6578\u3002\u5982\u4e0b :"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function f() {\n  return 'hello world';\n}\n\n// console.log(f()) //\u8f38\u51fa : Promise\xa0{<resolved>: \"hello world\"}\uff0c\u8aaa\u660easync\u51fd\u6578\u8fd4\u56de\u4e00\u500bPromise \u7269\u4ef6\n\nf().then(v => console.log(`\u6210\u529f ${v}`))//f() \u8fd4\u56de\u4e00\u500bPromise\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528then\u65b9\u6cd5\uff1b\u4e26\u4e14async\u51fd\u6578\u5167\u90e8return\u8a9e\u53e5\u8fd4\u56de\u7684\u503c\uff0c\u6703\u6210\u70bathen\u65b9\u6cd5\u56de\u8abf\u51fd\u6578\u7684\u53c3\u6578\u3002\n//\u8f38\u51fa : \u6210\u529f hello world\n")),Object(a.b)("p",null,"(3) async\u51fd\u6578\u8fd4\u56de\u7684Promise\u7269\u4ef6\uff0c\u6703\u5728\u5167\u90e8\u6240\u6709await\u547d\u4ee4\u5f8c\u9762\u7684Promise\u7269\u4ef6\u57f7\u884c\u5b8c\uff0c\u624d\u6703\u767c\u751f\u72c0\u614b\u6539\u8b8a\uff0c\u9664\u975e\u9047\u5230return\u8a9e\u53e5\u6216\u8005\u62cb\u51fa\u932f\u8aa4\u3002\u4e5f\u5c31\u662f\u8aaa\uff0c\u53ea\u6709async\u51fd\u6578\u5167\u90e8\u7684\u7570\u6b65\u64cd\u4f5c\u57f7\u884c\u5b8c\uff0c\u624d\u6703\u57f7\u884cthen\u51fd\u6578\u6307\u5b9a\u7684\u56de\u8abf\u51fd\u6578\u3002"),Object(a.b)("p",null,"\u4e0b\u9762\u662f\u4e00\u500b\u4f8b\u5b50\uff0c\u51fd\u6578getTitle\u5167\u90e8\u6709\u4e09\u500b\u64cd\u4f5c\uff1a\u6293\u53d6\u7db2\u9801\u3001\u53d6\u51fa\u6587\u672c\u3001\u5339\u914d\u9801\u9762\u6a19\u984c\u3002\u53ea\u6709\u9019\u4e09\u500b\u64cd\u4f5c\u5168\u90e8\u5b8c\u6210\uff0c\u624d\u6703\u57f7\u884cthen\u65b9\u6cd5\u88e1\u9762\u7684console.log\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function getTitle(url) {\n  let response = await fetch(url);\n  let html = await response.text();\n  return html.match(/<title>([\\s\\S]+)<\\/title>/i)[1];\n}\ngetTitle('https://my-json-server.typicode.com/taiwanhua/demo/getTitle').then(console.log)\n// \u8f38\u51fa : \"ECMAScript\xae 2020 Language&nbsp;Specification\"\n")),Object(a.b)("p",null,"(4) async\u51fd\u6578\u5167\u90e8\u62cb\u51fa\u932f\u8aa4\uff0c\u6703\u5c0e\u81f4Promise\u7269\u4ef6\u72c0\u614b\u767c\u751f\u6539\u8b8a\uff0c\u8b93\u5176\u8fd4\u56de\u7684Promise\u7269\u4ef6\u8b8a\u70bareject\u72c0\u614b\u3002\u800c\u62cb\u51fa\u7684\u932f\u8aa4\u7269\u4ef6\u6703\u88abcatch\u65b9\u6cd5\u56de\u8abf\u51fd\u6578\u6355\u7372\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function f() {\n  throw new Error('\u51fa\u932f\u4e86');\n}\n\nf().then(\n  v => console.log(`\u6210\u529f ${v}`),\n  e => console.log(`\u5931\u6557 ${e}`)\n)//\u89f8\u767c\u7b2c\u4e8c\u500b\u53c3\u6578 e => console.log(`\u5931\u6557 ${e}`)\n// \u8f38\u51fa : \u5931\u6557 Error: \u51fa\u932f\u4e86\n")),Object(a.b)("p",null,"(5) async\u51fd\u6578\u5167await\u547d\u4ee4\u5f8c\u9762\u7684Promise\u7269\u4ef6\u5982\u679c\u8b8a\u70bareject\u72c0\u614b\uff0c\u5247reject\u7684\u53c3\u6578\u4e5f\u6703\u88abcatch\u65b9\u6cd5\u7684\u56de\u8abf\u51fd\u6578\u6355\u7372\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function f() {\n  await Promise.reject('\u51fa\u932f\u4e86');\n}\n\nf()\n.then(v => console.log(`\u6210\u529f ${v}`))\n.catch(e => console.log(`\u5931\u6557 ${e}`))\n// \u51fa\u932f\u4e86\n")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"\u6ce8\u610f\uff0c\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0cawait\u8a9e\u53e5\u524d\u9762\u6c92\u6709return\uff0c\u4f46\u662freject\u65b9\u6cd5\u7684\u53c3\u6578\u4f9d\u7136\u50b3\u5165\u4e86catch\u65b9\u6cd5\u7684\u56de\u8abf\u51fd\u6578\u3002\u9019\u88e1\u5982\u679c\u5728await\u524d\u9762\u52a0\u4e0areturn\uff0c\u6548\u679c\u662f\u4e00\u6a23\u7684\u3002")),Object(a.b)("p",null,"(6) async\u51fd\u6578\u5167\u4efb\u4f55\u4e00\u500bawait\u8a9e\u53e5\u5f8c\u9762\u7684Promise\u7269\u4ef6\u8b8a\u70bareject\u72c0\u614b\uff0c\u90a3\u9ebc\u6574\u500basync\u51fd\u6578\u90fd\u6703\u4e2d\u65b7\u57f7\u884c\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function f() {\n  await Promise.reject('\u51fa\u932f\u4e86');\n  await Promise.resolve('hello world'); // \u4e0d\u6703\u88ab\u57f7\u884c\n}\n\nf()\n.then(\n  v => console.log(`\u6210\u529f ${v}`),\n  e => console.log(`\u5931\u6557 ${e}`) \n) //\u8f38\u51fa : \u5931\u6557 \u51fa\u932f\u4e86\n")),Object(a.b)("p",null,"\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7b2c\u4e8c\u500bawait\u8a9e\u53e5\u662f\u4e0d\u6703\u57f7\u884c\u7684\uff0c\u56e0\u70ba\u7b2c\u4e00\u500bawait\u8a9e\u53e5\u72c0\u614b\u8b8a\u6210\u4e86reject\u3002\n\u4f46\u662f\u6709\u6642\uff0c\u6211\u5011\u5e0c\u671b\u5373\u4f7f\u524d\u4e00\u500b\u7570\u6b65\u64cd\u4f5c\u5931\u6557\uff0c\u4e5f\u4e0d\u8981\u4e2d\u65b7\u5f8c\u9762\u7684\u7570\u6b65\u64cd\u4f5c\u3002\u9019\u6642\u53ef\u4ee5\u5c07\u7b2c\u4e00\u500bawait\u653e\u5728try...catch\u7d50\u69cb\u88e1\u9762\uff0c\u9019\u6a23\u4e0d\u7ba1\u9019\u500b\u7570\u6b65\u64cd\u4f5c\u662f\u5426\u6210\u529f\uff0c\u7b2c\u4e8c\u500bawait\u90fd\u6703\u57f7\u884c\u3002\u4f8b\u5982 : "),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"await\u547d\u4ee4\u5f8c\u9762\u7684Promise\u5c0d\u8c61\uff0c\u904b\u884c\u7d50\u679c\u53ef\u80fd\u662frejected\uff0c\u6240\u4ee5\u6700\u597d\u628aawait\u547d\u4ee4\u653e\u5728try...catch\u4ee3\u78bc\u584a\u4e2d\u3002")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function f() {\n  try {\n    await Promise.reject('\u51fa\u932f\u4e86');\n  } catch(e) {\n  }\n  return await Promise.resolve('hello world'); //\u82e5\u6c92\u6709return \uff0c\u5176\u503c\u5247\u4e0d\u6703\u50b3\u5165\u4e0b\u9762f()\n}\n\nf()\n.then(\n  v => console.log(`\u6210\u529f ${v}`),\n  e => console.log(`\u5931\u6557 ${e}`) \n)\n// \u8f38\u51fa : \u6210\u529f hello world\n\n\n// \u4e0b\u9762\u662f\u53e6\u4e00\u7a2e\u65b9\u6cd5\u662fawait\u5f8c\u9762\u7684Promise\u7269\u4ef6\u518d\u8ddf\u4e00\u500bcatch\u65b9\u6cd5\uff0c\u8655\u7406\u524d\u9762\u53ef\u80fd\u51fa\u73fe\u7684\u932f\u8aa4\u3002\n\nasync function f() {\n  await Promise.reject('\u51fa\u932f\u4e86')\n    .catch(e => console.log(e));\n  return await Promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// \u4f9d\u5e8f\u8f38\u51fa : \n// \u51fa\u932f\u4e86\n// hello world\n")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"\u5982\u679c\u6709\u591a\u500bawait\u547d\u4ee4\uff0c\u53ef\u4ee5\u7d71\u4e00\u653e\u5728try...catch\u7d50\u69cb\u4e2d\u3002")),Object(a.b)("p",null,"(7) \u5982\u679cawait\u5f8c\u9762\u7684\u7570\u6b65\u64cd\u4f5c\u51fa\u932f\uff0c\u90a3\u9ebc\u7b49\u540c\u65bcasync\u51fd\u6578\u8fd4\u56de\u7684Promise\u7269\u4ef6\u88abreject\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"async function f() {\n  await new Promise(function (resolve, reject) {\n    throw new Error('\u51fa\u932f\u4e86'); //await\u7684Promise\u7269\u4ef6\u6703\u62cb\u51fa\u4e00\u500b\u932f\u8aa4\n  });\n}\n\nf()\n.then(v => console.log(`\u6210\u529f ${v}`))\n.catch(e => console.log(`\u5931\u6557 ${e}`))\n// \u89f8\u767c\u7b2c\u4e8c\u500b\u53c3\u6578 e => console.log(`\u5931\u6557 ${e}`)\n// \u5931\u6557 Error: \u51fa\u9519\u4e86\n\n//\u9632\u6b62\u51fa\u932f\u7684\u65b9\u6cd5\uff0c\u4e5f\u662f\u5c07\u5176\u653e\u5728try...catch\u4ee3\u78bc\u584a\u4e4b\u4e2d\u3002\u5982\u4e0b : \n\nasync function f() {\n  try {\n    await new Promise(function (resolve, reject) {\n      throw new Error('\u51fa\u932f\u4e86');\n    });\n  } catch(e) {\n  }\n  return await('hello world');\n}\n\nf()\n.then(v => console.log(`\u6210\u529f ${v}`))\n.catch(e => console.log(`\u5931\u6557 ${e}`))\n")),Object(a.b)("h3",{id:"async-\u51fd\u6578\u4f75\u767c\u8207\u7e7c\u767c"},"async \u51fd\u6578\u4f75\u767c\u8207\u7e7c\u767c"),Object(a.b)("p",null,"(1) \u82e5async \u51fd\u6578\u5167\u591a\u500bawait\u547d\u4ee4\u5f8c\u9762\u7684\u7570\u6b65\u64cd\u4f5c\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7e7c\u767c\u95dc\u4fc2\uff0c\u90a3\u6700\u597d\u8b93\u5b83\u5011\u540c\u6642\u89f8\u767c\u3002\u4e0b\u97623\u500bfecth\u70ba\u7368\u7acb\u7684\u7570\u6b65\u64cd\u4f5c\uff08\u5373\u4e92\u4e0d\u4f9d\u8cf4\u5176\u4ed6fetch\u8fd4\u56de\u7684\u7d50\u679c\uff09\uff0c\u88ab\u5beb\u6210\u7e7c\u767c\u95dc\u4fc2\u3002\u9019\u6a23\u6bd4\u8f03\u8017\u6642\uff0c\u56e0\u70ba\u53ea\u6709\u7b2c\u4e00\u500bfetch\u5b8c\u6210\u4ee5\u5f8c\uff0c\u624d\u6703\u57f7\u884c\u4e0b\u4e00\u500bfetch\uff0c\u5176\u5be6\u53ef\u4ee5\u8b93\u5b83\u5011\u540c\u6642\u89f8\u767c\u66f4\u7bc0\u7701\u6642\u9593 (\u7a31\u70ba\u4f75\u767c) \u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"const asyncfunction = async () => {\n    await fetch('https://my-json-server.typicode.com/taiwanhua/demo/posts',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n\n    await fetch('https://my-json-server.typicode.com/taiwanhua/demo/comments',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (2)\xa0[{\u2026}, {\u2026}]\n\n    await fetch('https://my-json-server.typicode.com/taiwanhua/demo/profile', \n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : {name: \"typicode\"}\n}\n\nasyncfunction();\n")),Object(a.b)("p",null,"\u4e0b\u9762\u6211\u5011\u5c07\u4e0a\u65b9\u6539\u70ba\u4f75\u767c\u7684\u5beb\u6cd5"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"const asyncfunction = async () => {\n    let a =() => { fetch('https://my-json-server.typicode.com/taiwanhua/demo/posts',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n    }\n\n    let b =() => { fetch('https://my-json-server.typicode.com/taiwanhua/demo/comments',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (2)\xa0[{\u2026}, {\u2026}]\n    }\n\n    let c =() => { fetch('https://my-json-server.typicode.com/taiwanhua/demo/profile', \n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : {name: \"typicode\"}\n    }\n\n    await a();\n    await b();\n    await c();\n}\n\nasyncfunction();\n\n// \u7b49\u540c\u65bc\n\nconst asyncfunction = async () => {\n    let a =() => { fetch('https://my-json-server.typicode.com/taiwanhua/demo/posts',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (3)\xa0[{\u2026}, {\u2026}, {\u2026}]\n    }\n\n    let b =() => { fetch('https://my-json-server.typicode.com/taiwanhua/demo/comments',\n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : (2)\xa0[{\u2026}, {\u2026}]\n    }\n\n    let c =() => { fetch('https://my-json-server.typicode.com/taiwanhua/demo/profile', \n        { methods: 'GET' })\n        .then(response => response.json())\n        .then(json => console.log(json)); //\u9019\u500b\u6700\u5f8c\u6703\u8f38\u51fa : {name: \"typicode\"}\n    }\n\n    await Promise.all([ a(), b(), c()]);\n}\n\nasyncfunction();\n")),Object(a.b)("p",null,"(2) \u5be6\u969b\u958b\u767c\u4e2d\uff0c\u7d93\u5e38\u9047\u5230\u4e00\u7d44\u7570\u6b65\u64cd\u4f5c\uff0c\u9700\u8981\u6309\u7167\u9806\u5e8f\u5b8c\u6210\u3002\u6bd4\u5982\uff0c\u4f9d\u6b21\u8b80\u53d6\u4e00\u7d44URL\uff0c\u7136\u5f8c\u6309\u7167\u8b80\u53d6\u7684\u9806\u5e8f\u8f38\u51fa\u7d50\u679c\u3002\u9996\u5148\u5982\u4e0b\u9762\u90a3\u7a2e\u5beb\u6cd5\uff0c\u6240\u6709\u9060\u7a0b\u64cd\u4f5c\u90fd\u662f\u7e7c\u767c\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"let urlsArr = [\n    'https://my-json-server.typicode.com/taiwanhua/demo/posts',\n    'https://my-json-server.typicode.com/taiwanhua/demo/comments',\n    'https://my-json-server.typicode.com/taiwanhua/demo/profile'\n];\n\nasync function logInOrder(urls) {\n  for (const url of urls) {\n    const response = await fetch(url);\n    console.log(await response.text());\n  }\n}\n\nlogInOrder(urlsArr);\n")),Object(a.b)("p",null,"\u554f\u984c\u662f\u8aaa\u5728\u4e92\u4e0d\u4f9d\u8cf4\u5176\u4ed6fetch\u8fd4\u56de\u7684\u7d50\u679c\u7684\u60c5\u6cc1\u4e0b\uff0c\u53ea\u6709\u524d\u4e00\u500bURL \u8fd4\u56de\u7d50\u679c\uff0c\u624d\u6703\u53bb\u8b80\u53d6\u4e0b\u4e00\u500bURL\uff0c\u9019\u6a23\u505a\u6548\u7387\u5f88\u5dee\uff0c\u975e\u5e38\u6d6a\u8cbb\u6642\u9593\u3002\u6211\u5011\u9700\u8981\u7684\u662f\u4f75\u767c\u767c\u51fa\u9060\u7a0b\u8acb\u6c42\u3002"),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"\u4e0b\u9762\u96d6\u7136map\u65b9\u6cd5\u7684\u53c3\u6578\u662fasync\u51fd\u6578\uff0c\u4f46\u5b83\u662f\u4e26\u767c\u57f7\u884c\u7684\uff0c\u56e0\u70ba\u53ea\u6709async\u51fd\u6578\u5167\u90e8\u662f\u7e7c\u767c\u57f7\u884c\uff0c\u5916\u90e8\u4e0d\u53d7\u5f71\u97ff\u3002\u5f8c\u9762\u7684for..of\u5faa\u74b0\u5167\u90e8\u4f7f\u7528\u4e86await\uff0c\u56e0\u6b64\u5be6\u73fe\u4e86\u6309\u9806\u5e8f\u8f38\u51fa\u3002")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"let urlsArr = [\n    'https://my-json-server.typicode.com/taiwanhua/demo/posts',\n    'https://my-json-server.typicode.com/taiwanhua/demo/comments',\n    'https://my-json-server.typicode.com/taiwanhua/demo/profile'\n];\n\nasync function logInOrder(urls) {\n  // \u4f75\u767c\u8b80\u53d6url\n  const textPromises = urls.map(async url => { //\u6ce8\u610f\u9019\u88e1 \u96d6\u7136map\u65b9\u6cd5\u7684\u53c3\u6578\u662fasync\u51fd\u6578\uff0c\u4f46\u5b83\u662f\u4e26\u767c\u57f7\u884c\u7684\n    const response = await fetch(url);\n    return response.text();\n  });\n\n  // \u6309\u6b21\u5e8f\u8f38\u51fa\n  for (const textPromise of textPromises) {\n    console.log(await textPromise);\n  }\n}\n\nlogInOrder(urlsArr);\n")),Object(a.b)("h2",{id:"\u4f7f\u7528\u578b\u5f0f"},"\u4f7f\u7528\u578b\u5f0f"),Object(a.b)("p",null,"async\u51fd\u6578\u5177\u6709\u591a\u7a2e\u4f7f\u7528\u578b\u5f0f\uff0c\u4ee5\u4e0b\u505a\u4e00\u6574\u5f59\u3002"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-javascript"}),"// \u51fd\u6578\u5ba3\u544a\nasync function foo() {}\n\n// \u51fd\u6578\u8868\u9054\u5f0f\nconst foo = async function () {};\n\n// \u7269\u4ef6\u7684\u65b9\u6cd5\nlet obj = { async foo() {} };\nobj.foo().then(...)\n\n// Class \u7684\u65b9\u6cd5\nclass Storage {\n  constructor() {\n    this.cachePromise = caches.open('avatars');\n  }\n\n  async getAvatar(name) {\n    const cache = await this.cachePromise;\n    return cache.match(`/avatars/${name}.jpg`);\n  }\n}\n\nconst storage = new Storage();\nstorage.getAvatar('jake').then(\u2026);\n\n// \u7bad\u982d\u51fd\u6578\nconst foo = async () => {};\n")),Object(a.b)("h2",{id:"async-\u51fd\u6578\u7a0b\u5f0f\u78bc\u7247\u6bb5-snippets\u9023\u7d50"},Object(a.b)("a",Object(o.a)({parentName:"h2"},{href:"./AsyncSnippets"}),"Async \u51fd\u6578\u7a0b\u5f0f\u78bc\u7247\u6bb5 (Snippets)\u9023\u7d50")))}i.isMDXComponent=!0}}]);